(()=>{"use strict";let t=canvas.getContext("2d"),i=collisionCanvas.getContext("2d");class e{constructor(){this.spriteWidth=396,this.spriteHeight=582,this.sizeModifier=.2*Math.random()+.4,this.width=this.spriteWidth*this.sizeModifier/3,this.height=this.spriteHeight*this.sizeModifier/3,this.x=canvas.width,this.y=Math.random()*(canvas.height-this.height),this.directionX=2*Math.random()+2,this.directionY=2*Math.random(),this.markedForDeletion=!1,this.image=new Image,this.image.src="./Sprites/ghostspritesheet.png",this.frame=0,this.maxFrame=8,this.timeSinceStep=0,this.stepInterval=100,this.randomColors=[Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())],this.color="rgb("+this.randomColors[0]+","+this.randomColors[1]+","+this.randomColors[2]+")"}update(t){(this.y<0||this.y>canvas.height-this.height)&&(this.directionY=-1*this.directionY),this.x-=this.directionX,this.y+=this.directionY,this.x<0-this.width&&(this.markedForDeletion=!0),this.timeSinceStep+=t,this.timeSinceStep>this.stepInterval&&(this.frame>this.maxFrame?this.frame=0:this.frame++,this.timeSinceStep=0)}draw(){i.fillStyle=this.color,i.fillRect(this.x,this.y,this.width,this.height),t.drawImage(this.image,this.frame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.width,this.height)}}let h=document.getElementById("canvas"),s=h.getContext("2d"),n=document.getElementById("collisionCanvas"),o=n.getContext("2d"),a=[];n.width=window.innerWidth,n.height=window.innerHeight,h.width=window.innerWidth,h.height=window.innerHeight,s.font="50px Impact";let r=!1,d=!1,m={x:0,y:0,dx:0,dy:0,px:0,py:0},l=0,c=0,g=[],f=0;function p(){r&&requestAnimationFrame(p),function(t){for(var i=t.length;i--;){var e=t[i],h=e.x,n=e.y,o=e.size;u(h,n,o,s),e.dy-=.2,e.x-=e.dx,e.y-=e.dy,e.size-=.05,(t[i].size<.3||Math.random()<.04)&&(u(h,n,o,s),t.splice(i,1))}}(a)}function y(t,i,e){for(var h=0;h<30;h++){var s=Math.random()*Math.PI,n=(Math.random()<.5?3:-3)*(3*Math.random())*0,o=(Math.random()<.5?3:-3)*(3*Math.random())*0;e.push({x:t,y:i,dx:n+m.dx,dy:o+m.dy,size:s})}}function u(t,i,e,h){h.beginPath(),h.arc(t,i,5*e,0,2*Math.PI,!1),h.fill(),h.closePath()}window.addEventListener("click",(function(t){!function(){let t=new Audio("raygunsound.mp3");t.play(),t.setAttribute("id","rayGunSound"),t.loop=!1}(),function(){let t=document.getElementById("raygun");t.src="coloredraygunfire.png",setTimeout((function(){t.src="coloredraygun.png"}),100)}();const i=o.getImageData(t.x,t.y,1,1).data;g.forEach((e=>{e.randomColors[0]===i[0]&&e.randomColors[1]===i[1]&&e.randomColors[2]===i[2]&&(e.markedForDeletion=!0,f++,r?(d=!0,setTimeout((function(){d=!1}),100),m.x=t.pageX,m.y=t.pageY,s.fillStyle="#ffffff",y(m.x,m.y,a),setTimeout((function(){s.clearRect(0,0,h.width,h.height)}),1e3)):(r=!0,p()))}))})),function t(i){s.clearRect(0,0,h.width,h.height),o.clearRect(0,0,h.width,h.height);let n=i-c;c=i,l+=n,l>500&&(g.push(new e),l=0),s.fillStyle="white",s.fillText("Kills: "+f,h.width/2,h.height/8),[...g].forEach((t=>t.update(n))),[...g].forEach((t=>t.draw())),g=g.filter((t=>!t.markedForDeletion)),requestAnimationFrame(t)}(0),h.onmousemove=function(t){if(d){var i=m.px-m.x,e=m.py-m.y;m={x:t.pageX,y:t.pageY,dx:Math.abs(i)>10?-10:i,dy:Math.abs(e)>10?-10:e,px:m.x,py:m.y},y(m.x,m.y,a)}},h.addEventListener("mousemove",(t=>{document.getElementById("raygun").style.top=t.pageY+"px"}))})();