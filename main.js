(()=>{"use strict";let t=document.getElementById("soundEfx");function i(t,i,e,s){s.beginPath(),s.arc(t,i,5*e,0,2*Math.PI,!1),s.fill(),s.closePath()}function e(){focused&&requestAnimationFrame(e),function(t){let e=t.length;for(;e--;){let s=t[e],o=s.x,n=s.y,a=s.size;i(o,n,a,ctx),s.dy-=options.gravity,s.x-=s.dx,s.y-=s.dy,s.size-=.05,(t[e].size<.3||Math.random()<options.consistency)&&(i(o,n,a,ctx),t.splice(e,1))}}(items)}function s(t,i,e){for(let s=0;s<30;s++){let s=Math.random()*Math.PI,o=(Math.random()<.5?3:-3)*(3*Math.random())*options.scatter,n=(Math.random()<.5?3:-3)*(3*Math.random())*options.scatter;e.push({x:t,y:i,dx:o+mouse.dx,dy:n+mouse.dy,size:s})}}class o{constructor(){this.spriteWidth=396,this.spriteHeight=582,this.sizeModifier=.2*Math.random()+.4,this.width=this.spriteWidth*this.sizeModifier/3,this.height=this.spriteHeight*this.sizeModifier/3,this.x=canvas.width,this.y=Math.random()*(canvas.height-this.height),this.directionX=2*Math.random()+2,this.directionY=2*Math.random(),this.markedForDeletion=!1,this.image=new Image,this.image.src="./Sprites/ghostspritesheet.png",this.frame=0,this.maxFrame=8,this.timeSinceStep=0,this.stepInterval=100,this.randomColors=[Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())],this.color="rgb("+this.randomColors[0]+","+this.randomColors[1]+","+this.randomColors[2]+")"}update(t){(this.y<0||this.y>canvas.height-this.height)&&(this.directionY=-1*this.directionY),this.x-=this.directionX,this.y+=this.directionY,this.x<0-this.width&&(this.markedForDeletion=!0),this.timeSinceStep+=t,this.timeSinceStep>this.stepInterval&&(this.frame>this.maxFrame?this.frame=0:this.frame++,this.timeSinceStep=0),this.x<0-this.width&&(gameEnd=!0,kills=0)}draw(){collisionCtx.fillStyle=this.color,collisionCtx.fillRect(this.x,this.y,this.width,this.height),ctx.drawImage(this.image,this.frame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.width,this.height)}}let n=document.getElementById("bgmEfx");window.canvas=document.getElementById("canvas"),window.ctx=canvas.getContext("2d"),window.collisionCanvas=document.getElementById("collisionCanvas"),window.collisionCtx=collisionCanvas.getContext("2d"),window.items=[],window.kills=0,window.tone="#ffffff",collisionCanvas.width=window.innerWidth,collisionCanvas.height=window.innerHeight,canvas.width=window.innerWidth,canvas.height=window.innerHeight,ctx.font="50px Impact",window.focused=!1,window.clicked=!1,window.gameEnd=!1,window.mouse={x:0,y:0,dx:0,dy:0,px:0,py:0},window.options={scatter:0,gravity:.2,consistency:.04};let a=0,h=0,d=[];function c(t){ctx.clearRect(0,0,canvas.width,canvas.height),collisionCtx.clearRect(0,0,canvas.width,canvas.height);let i=t-h;h=t,a+=i,a>500&&(d.push(new o),a=0),ctx.fillStyle="white",ctx.fillText("Busts: "+kills,canvas.width/2,canvas.height/8),[...d].forEach((t=>t.update(i))),[...d].forEach((t=>t.draw())),d=d.filter((t=>!t.markedForDeletion)),gameEnd||requestAnimationFrame(c)}canvas.addEventListener("mousemove",(t=>{document.getElementById("raygun").style.top=t.pageY+"px"})),window.addEventListener("click",(function(i){!function(){if("block"==canvas.style.display&&0==t.checked){let t=new Audio("raygunsound.mp3");t.play(),t.setAttribute("id","rayGunSound"),t.loop=!1}}(),function(){let t=document.getElementById("raygun");t.src="coloredraygunfire.png",setTimeout((function(){t.src="coloredraygun.png"}),100)}();const o=collisionCtx.getImageData(i.x,i.y,1,1).data;d.forEach((t=>{t.randomColors[0]===o[0]&&t.randomColors[1]===o[1]&&t.randomColors[2]===o[2]&&(t.markedForDeletion=!0,kills++,focused?(clicked=!0,setTimeout((function(){clicked=!1}),100),mouse.x=i.pageX,mouse.y=i.pageY,ctx.fillStyle=tone,s(mouse.x,mouse.y,items),setTimeout((function(){ctx.clearRect(0,0,canvas.width,canvas.height)}),1e3)):(focused=!0,e()))}))}));let l=document.getElementById("startGameButton"),r=document.querySelector(".startGame"),m=document.getElementById("raygun");l.addEventListener("click",(function(){c(0),canvas.style.display="block",collisionCanvas.style.display="block",r.style.display="none",m.style.display="flex",function(){if("block"==canvas.style.display&&0==n.checked){let t=new Audio("backgroundsound.mp3");t.play(),t.setAttribute("id","backgroundSound"),t.loop=!0}}()})),canvas.onmousemove=function(t){if(clicked){let i=mouse.px-mouse.x,e=mouse.py-mouse.y;mouse={x:t.pageX,y:t.pageY,dx:Math.abs(i)>10?-10:i,dy:Math.abs(e)>10?-10:e,px:mouse.x,py:mouse.y},s(mouse.x,mouse.y,items)}}})();