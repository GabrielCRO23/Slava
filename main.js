(()=>{"use strict";var t=document.getElementById("canvas"),i=!1,e=t.getContext("2d"),h=!1,o=[];t.width=window.innerWidth,t.height=window.innerHeight;var n=document.getElementById("collisionCanvas"),s=n.getContext("2d");n.width=window.innerWidth,n.height=window.innerHeight;var r={x:0,y:0,dx:0,dy:0,px:0,py:0};let a=0,d=0,c=[];class m{constructor(){this.spriteWidth=800,this.spriteHeight=600,this.sizeModifier=.2*Math.random()+.4,this.width=this.spriteWidth*this.sizeModifier/3,this.height=this.spriteHeight*this.sizeModifier/3,this.x=t.width,this.y=Math.random()*(t.height-this.height),this.directionX=2*Math.random()+2,this.directionY=2*Math.random(),this.markedForDeletion=!1,this.image=new Image,this.image.src="./Sprites/rotatedspritesheet.png",this.frame=0,this.maxFrame=8,this.timeSinceStep=0,this.stepInterval=100,this.randomColors=[Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())],this.color="rgb("+this.randomColors[0]+","+this.randomColors[1]+","+this.randomColors[2]+")"}update(i){(this.y<0||this.y>t.height-this.height)&&(this.directionY=-1*this.directionY),this.x-=this.directionX,this.y+=this.directionY,this.x<0-this.width&&(this.markedForDeletion=!0),this.timeSinceStep+=i,this.timeSinceStep>this.stepInterval&&(this.frame>this.maxFrame?this.frame=0:this.frame++,this.timeSinceStep=0)}draw(){s.fillStyle=this.color,s.fillRect(this.x,this.y,this.width,this.height),e.drawImage(this.image,this.frame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.width,this.height)}}function l(){i&&requestAnimationFrame(l),function(t){for(var i=t.length;i--;){var h=t[i],o=h.x,n=h.y,s=h.size;y(o,n,s,e),h.dy-=.2,h.x-=h.dx,h.y-=h.dy,h.size-=.05,(t[i].size<.3||Math.random()<.04)&&(y(o,n,s,e),t.splice(i,1))}}(o)}function g(t,i,e){for(var h=0;h<30;h++){var o=Math.random()*Math.PI,n=(Math.random()<.5?3:-3)*(3*Math.random())*0,s=(Math.random()<.5?3:-3)*(3*Math.random())*0;e.push({x:t,y:i,dx:n+r.dx,dy:s+r.dy,size:o})}}function y(t,i,e,h){h.beginPath(),h.arc(t,i,5*e,0,2*Math.PI,!1),h.fill(),h.closePath()}window.addEventListener("click",(function(n){!function(){let t=new Audio("raygunsound.mp3");t.play(),t.setAttribute("id","rayGunSound"),t.loop=!1}();let a=document.getElementById("raygun");a.src="coloredraygunfire.png",setTimeout((function(){a.src="coloredraygun.png"}),100);const d=s.getImageData(n.x,n.y,1,1).data;c.forEach((s=>{s.randomColors[0]===d[0]&&s.randomColors[1]===d[1]&&s.randomColors[2]===d[2]&&(s.markedForDeletion=!0,i?(h=!0,setTimeout((function(){h=!1}),100),r.x=n.pageX,r.y=n.pageY,e.fillStyle="#c1c121",g(r.x,r.y,o),setTimeout((function(){e.clearRect(0,0,t.width,t.height)}),1e3)):(i=!0,l()))}))})),function i(h){e.clearRect(0,0,t.width,t.height),s.clearRect(0,0,t.width,t.height);let o=h-d;d=h,a+=o,a>500&&(c.push(new m),a=0),[...c].forEach((t=>t.update(o))),[...c].forEach((t=>t.draw())),c=c.filter((t=>!t.markedForDeletion)),requestAnimationFrame(i)}(0),n.addEventListener("click",(function(){console.log("hey")})),window.addEventListener("click",(function(){console.log("hey")})),t.onmousemove=function(t){if(h){var i=r.px-r.x,e=r.py-r.y;g((r={x:t.pageX,y:t.pageY,dx:Math.abs(i)>10?-10:i,dy:Math.abs(e)>10?-10:e,px:r.x,py:r.y}).x,r.y,o)}},t.addEventListener("mousemove",(t=>{document.getElementById("raygun").style.top=t.pageY+"px"}))})();